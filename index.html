<!DOCTYPE html> 
<html>
    <head>
        <title>BIB</title>
    </head>
<style>
#field {
    border: 0.5px dashed green;
}
</style>
<body>
    <canvas id="field"></canvas><br>
    <button onclick="draw()">Draw</button>
    <button onclick="move()">Move</button>
</body>
</html>

<script>
const canvas = document.getElementById("field");
const context = canvas.getContext("2d");
canvas.width = 500;
canvas.height = 500;
const Ocell = {
    size: 5
}
let liveCells = 0;
let cells = [];
let Lcell = [];
var x = 0,
    y = 0;

function getRandomString(length) {
    var chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()';
    var charLength = chars.length;
    var result = '';
    for (var i = 0; i < length; i++) {
        result += chars.charAt(Math.floor(Math.random() * charLength));
    }
    return result;
}
function getRandomInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}
function getRadians(degrees) {
 return (Math.PI / 180) * degrees;
}
// class world {
//     constructor(Ccell) {
//         this.Ccell = Ccell;
//     }
//     show() {
//         console.log(this.Ccell);
//     }
// }
// var worldd = new world(0);
class cell {
    constructor(x, y, h, w, empty) {
        this.x = x;
        this.y = y;
        this.h = h;
        this.w = w;
        this.empty = empty;
        this.move=0
        this.age = getRandomInt(50, 150);
    }
    draw() {
        if (this.empty === 0) context.fillStyle = "green";
        if (this.empty === 1) context.fillStyle = "white";
        if (this.empty === 2) context.fillStyle = "darkblue";
        context.fillRect(this.x, this.y, this.h, this.w);
    }
    Cmove() {
        if (this.age === 0) this.empty = 1;
        if (this.age < 0) this.empty = 2;
        if (this.empty === 0){
        this.move = getRandomInt(0, 4);
         if (this.move===0) this.x+=Ocell.size;
         if (this.move===1) this.x-=Ocell.size;
         if (this.move===2) this.y+=Ocell.size;
         if (this.move===3) this.y-=Ocell.size;
         this.age-=1.5
        }
    }
}
//names for Cells
for (var i = 0; i<7000; i++) {
    bib = getRandomString(3);
    cells.push(bib);
}

//Cells generation
for (var i = 0; i < cells.length; i++) {
    var bib = cells[i];
    var bib2 = new cell(x, y, Ocell.size, Ocell.size, getRandomInt(0, 1));
    Lcell.push(bib2);
    //move on screen
    x+=Ocell.size;
    if(x === canvas.width) {
        y+=Ocell.size;
        x=0;
    } 
}
function checkCells() {
    liveCount = 0
    for (var i = 0; i < cells.length; i++) {
        if (Lcell[i].empty === 0) liveCount+=1
    }
    document.title = liveCount;
    return liveCount;
}
 
function draw() {
    for (var i = 0; i < cells.length; i++) {
        Lcell[i].draw();
    }
    checkCells();
}
function move() {
    for (var i = 0; i < cells.length; i++) {
        Lcell[i].Cmove();   
    }
    context.clearRect(0, 0, canvas.width, canvas.height)
    draw();
    
}
draw();

let timerId = setInterval(move, 100);
</script>
